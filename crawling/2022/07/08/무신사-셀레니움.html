<h1 id="무신사-selenium">무신사 selenium</h1>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">re</span>

<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>
<span class="kn">from</span> <span class="nn">selenium</span> <span class="kn">import</span> <span class="n">webdriver</span>

</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">warnings</span><span class="p">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s">'ignore'</span><span class="p">)</span>
</code></pre></div></div>

<p>무신사 접속 -&gt; 상의(전체보기) 카테고리 페이지로 접속을 한다.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#
# 무신사 접속 -&gt; 상의(전체보기) 카테고리 페이지로 접속을 한다.
</span><span class="n">url</span> <span class="o">=</span> <span class="s">'https://www.musinsa.com/category/001'</span>

<span class="c1"># 본인의 크롬 드라이버 절대주소
</span><span class="n">driver</span> <span class="o">=</span> <span class="n">webdriver</span><span class="p">.</span><span class="n">Chrome</span><span class="p">(</span><span class="s">'본인의 크롬 드라이버 절대주소 혹은 상대주소'</span><span class="p">)</span>

<span class="n">driver</span><span class="p">.</span><span class="n">implicitly_wait</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># 웹 페이지 로딩 최대 5초 대기
</span><span class="n">driver</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#
# 가장 첫번째 옷 아이템의 사진을 클릭 
</span>
<span class="n">driver</span><span class="p">.</span><span class="n">find_element_by_css_selector</span><span class="p">(</span><span class="s">'#searchList &gt; li:nth-child(1) &gt; div.li_inner &gt; div.list_img &gt; a &gt; img'</span><span class="p">).</span><span class="n">click</span><span class="p">()</span>

</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#
# 상세 페이지 옷 사진 가져오기
</span>
<span class="c1"># img css selector을 가져온 후 
</span><span class="n">image</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="n">find_element_by_css_selector</span><span class="p">(</span><span class="s">'#detail_bigimg &gt; div.product-img &gt; img'</span><span class="p">)</span>
<span class="c1"># src 태그를 가져온다 
</span><span class="n">src</span> <span class="o">=</span> <span class="n">image</span><span class="p">.</span><span class="n">get_attribute</span><span class="p">(</span><span class="s">'src'</span><span class="p">)</span> 
<span class="k">print</span><span class="p">(</span><span class="n">src</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://image.msscdn.net/images/goods_img/20210316/1848166/1848166_11_500.jpg?t=20220404173105
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#
# 상품 이름 
</span><span class="n">product_name</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="n">find_element_by_css_selector</span><span class="p">(</span><span class="s">'#page_product_detail &gt; div.right_area.page_detail_product &gt; div.right_contents.section_product_summary &gt; span &gt; em'</span><span class="p">).</span><span class="n">text</span>
<span class="k">print</span><span class="p">(</span><span class="n">product_name</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>에센셜 쿨 코튼 2-PACK 티셔츠
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#
# 브랜드 이름
# brand_name = driver.find_element_by_css_selector('#product_order_info &gt; div.explan_product.product_info_section &gt; ul &gt; li:nth-child(1) &gt; p.product_article_contents &gt; strong &gt; a').text
# brand_name 
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#
# #product_order_info &gt; div.explan_product.product_info_section &gt; ul &gt; li:nth-child(1) &gt; p.product_article_contents &gt; strong
# 브랜드 이름과 품번 가져오기
</span>
<span class="n">product_brand</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="n">find_element_by_css_selector</span><span class="p">(</span><span class="s">'#product_order_info &gt; div.explan_product.product_info_section &gt; ul &gt; li:nth-child(1) &gt; p.product_article_contents &gt; strong'</span><span class="p">).</span><span class="n">text</span>
<span class="n">brand_id</span> <span class="o">=</span> <span class="n">product_brand</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">'/'</span><span class="p">)</span> 
<span class="n">brand_id</span> <span class="o">=</span> <span class="p">[</span><span class="n">elem</span><span class="p">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">brand_id</span><span class="p">]</span>
<span class="n">brand_name</span> <span class="o">=</span> <span class="n">brand_id</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">product_id</span> <span class="o">=</span> <span class="n">brand_id</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">brand_name</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">product_id</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>COVERNAT
CO0000STE1BK
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#
# 시즌 정보와 성별 가져오기
</span>
<span class="n">season_gender</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="n">find_element_by_css_selector</span><span class="p">(</span><span class="s">'#product_order_info &gt; div.explan_product.product_info_section &gt; ul &gt; li:nth-child(2) &gt; p.product_article_contents'</span><span class="p">).</span><span class="n">text</span>
<span class="n">season_gender</span> <span class="o">=</span> <span class="n">season_gender</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">'/'</span><span class="p">)</span> 
<span class="n">season_gender</span> <span class="o">=</span> <span class="p">[</span><span class="n">elem</span><span class="p">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">season_gender</span><span class="p">]</span>
<span class="n">season</span> <span class="o">=</span> <span class="n">season_gender</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span><span class="s">'/'</span><span class="o">+</span> <span class="n">season_gender</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">gender</span> <span class="o">=</span> <span class="n">season_gender</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">season</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">gender</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2022 S/S
남 여
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#
# 상품 가격 가져오기
</span>
<span class="n">price</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="n">find_element_by_css_selector</span><span class="p">(</span><span class="s">'#goods_price &gt; del'</span><span class="p">).</span><span class="n">text</span>
<span class="n">price</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">sub</span><span class="p">(</span><span class="s">'[-=.,#/?:$}원]'</span><span class="p">,</span> <span class="s">''</span><span class="p">,</span> <span class="n">price</span><span class="p">)</span>
<span class="n">price</span>

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'49000'
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#
# 해시태그 가져오기
</span>
<span class="c1"># #product_order_info &gt; div.explan_product.product_info_section &gt; ul &gt; li.article-tag-list.list &gt; p
</span>
<span class="n">hashtag</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="n">find_element_by_css_selector</span><span class="p">(</span><span class="s">'#product_order_info &gt; div.explan_product.product_info_section &gt; ul &gt; li.article-tag-list.list &gt; p'</span><span class="p">).</span><span class="n">text</span>

<span class="n">hashtag</span> <span class="o">=</span> <span class="n">hashtag</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span>

<span class="c1"># 정규표현식을 통해 #(특수기호) 제거
</span><span class="n">hashtag</span> <span class="o">=</span> <span class="p">[</span><span class="n">re</span><span class="p">.</span><span class="n">sub</span><span class="p">(</span><span class="s">'[-=.#/?:$}]'</span><span class="p">,</span> <span class="s">''</span><span class="p">,</span> <span class="n">elem</span><span class="p">)</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">hashtag</span><span class="p">]</span>
<span class="n">hashtag</span>

</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>['반팔티셔츠',
 '티셔츠',
 '반팔티',
 '오버핏반팔',
 '에센셜라인',
 '쿨코튼',
 '썸머컬렉션',
 '로고티셔츠',
 '입시덕후',
 '깡스타일리스트PICK']
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#
# 좋야요 개수
# #product-top-like &gt; p.product_article_contents.goods_like_1848166 &gt; span
</span>
<span class="n">like</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="n">find_element_by_css_selector</span><span class="p">(</span><span class="s">'#product-top-like &gt; p.product_article_contents.goods_like_1848166 &gt; span'</span><span class="p">).</span><span class="n">text</span>
<span class="n">like</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">sub</span><span class="p">(</span><span class="s">'[^0-9]'</span><span class="p">,</span> <span class="s">''</span><span class="p">,</span> <span class="n">like</span><span class="p">)</span>
<span class="n">like</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'126089'
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#
# 평점
</span><span class="n">rate</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="n">find_element_by_css_selector</span><span class="p">(</span><span class="s">'#product_order_info &gt; div.explan_product.product_info_section &gt; ul &gt; li:nth-child(6) &gt; p.product_article_contents &gt; a &gt; span.prd-score__rating'</span><span class="p">).</span><span class="n">text</span>
<span class="n">rate</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'4.8'
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#
# 구매 후기 개수 -&gt; 평점과 구매 후기 개수를 곱해서 유의미한 feature을 만들어 낼 수 있을 것 같음 
</span><span class="n">rate_num</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="n">find_element_by_css_selector</span><span class="p">(</span><span class="s">'#product_order_info &gt; div.explan_product.product_info_section &gt; ul &gt; li:nth-child(6) &gt; p.product_article_contents &gt; a &gt; span.prd-score__review-count'</span><span class="p">).</span><span class="n">text</span>
<span class="n">rate_num</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="n">sub</span><span class="p">(</span><span class="s">'[^0-9]'</span><span class="p">,</span> <span class="s">''</span><span class="p">,</span> <span class="n">rate_num</span><span class="p">)</span>
<span class="n">rate_num</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'32374'
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#
# 구매 현황 (purchase status)
# ~18세 / 19 ~ 23세 / 24 ~ 28세 / 29 ~ 33세 / 34 ~ 39세 / 40세 ~ 
</span>
<span class="n">purchase_status</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="n">find_element_by_css_selector</span><span class="p">(</span><span class="s">'#page_product_detail &gt; div.right_area.page_detail_product &gt; div.section_graph_detail &gt; div &gt; div &gt; div.graph_bar_wrap &gt; div &gt; ul'</span><span class="p">).</span><span class="n">text</span>
<span class="n">purchase_status</span> <span class="o">=</span> <span class="n">purchase_status</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">'</span><span class="se">\n</span><span class="s">'</span><span class="p">)</span> 

<span class="n">cleaned_purchase_status</span> <span class="o">=</span> <span class="p">[</span><span class="n">elem</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">purchase_status</span> <span class="k">if</span> <span class="s">'%'</span> <span class="ow">in</span> <span class="n">elem</span><span class="p">]</span>
<span class="n">cleaned_purchase_status</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>['37%', '21%', '19%', '11%', '4%', '8%']
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#
# 남성 구매 비율 (파이 차트)
</span>
<span class="n">purchase_men</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="n">find_element_by_css_selector</span><span class="p">(</span><span class="s">'#graph_doughnut_label &gt; ul &gt; li:nth-child(1) &gt; dl &gt; dd'</span><span class="p">).</span><span class="n">text</span>
<span class="n">purchase_men</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'64%'
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#
# 여성 구매 비율 (파이 차트)
</span>
<span class="n">purchase_women</span> <span class="o">=</span> <span class="n">driver</span><span class="p">.</span><span class="n">find_element_by_css_selector</span><span class="p">(</span><span class="s">'#graph_doughnut_label &gt; ul &gt; li:nth-child(2) &gt; dl &gt; dd'</span><span class="p">).</span><span class="n">text</span>
<span class="n">purchase_women</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>'36%'
</code></pre></div></div>

